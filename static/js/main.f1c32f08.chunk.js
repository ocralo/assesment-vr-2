(this["webpackJsonpvideorecording-threejs"]=this["webpackJsonpvideorecording-threejs"]||[]).push([[0],{51:function(e,t,a){e.exports=a(78)},55:function(e,t,a){},78:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(41),o=a.n(c),l=(a(55),a(7)),s=a(6),i=a(18),m=a(9),u=a(13),d=a(50),b=function(e){var t=e.component,a=e.user,n=Object(d.a)(e,["component","user"]);return r.a.createElement(m.b,Object.assign({},n,{render:function(e){return a?r.a.createElement(t,Object.assign({},n,e)):r.a.createElement(m.a,{to:{pathname:"/",state:{from:e.location}}})}}))};function v(e){var t=e.userMail,a=Object(m.g)();return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},r.a.createElement(i.b,{className:"navbar-brand",to:"/test"},r.a.createElement("img",{src:"".concat(".","/Assets/images/kaleidolab.jpg"),alt:"",width:"120"})),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarTogglerDemo02","aria-controls":"navbarTogglerDemo02","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarTogglerDemo02"},r.a.createElement("ul",{className:"navbar-nav mr-auto mt-2 mt-lg-0"},r.a.createElement("li",{className:"nav-item active"}),r.a.createElement("li",{className:"nav-item active"})),""!==t?r.a.createElement("div",{className:"dropdown"},r.a.createElement("button",{className:"btn btn-secondary dropdown-toggle my-2 my-lg-0",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},t),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},r.a.createElement(i.b,{className:"dropdown-item",to:"",onClick:function(){u.auth().signOut().then((function(){a.push("/")})).catch((function(e){}))}},"Cerrar sesion"))):""))}function p(e){var t=e.SetStateRoute,a=Object(n.useState)({userName:"",password:""}),c=Object(s.a)(a,2),o=c[0],i=c[1],d=Object(m.g)();var b=function(){u.auth().signInWithEmailAndPassword(o.userName,o.password).then((function(e){t(!0),d.push("/test")})).catch((function(e){alert("No se pudo iniciar sesion")}))};function v(e){var t=e.target.name,a=e.target.value;i("userName"===t?Object(l.a)(Object(l.a)({},o),{},{userName:a}):Object(l.a)(Object(l.a)({},o),{},{password:a}))}return r.a.createElement("div",{className:"container-fluid vh-100"},r.a.createElement("div",{className:"row justify-content-center h-100"},r.a.createElement("div",{className:"col-md-6 d-flex align-items-center"},r.a.createElement("div",{className:"card shadow w-100",style:{height:"35em"}},r.a.createElement("div",{className:"card-header d-flex flex-column align-items-center justify-content-center bg-white border-bottom-0"},r.a.createElement("img",{src:"".concat(".","/Assets/images/kaleidolab.jpg"),alt:"",width:"300"}),r.a.createElement("h3",null,"Assessment VR"),r.a.createElement("p",{className:"text-center"},"La experiencia de realidad virtual para desarrollar y aplicar evaluaciones de comportamientos ante situaciones inesperadas")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),b()}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"usuario"},"Usuario"),r.a.createElement("input",{type:"text",className:"form-control",id:"usuario","aria-describedby":"emailHelp",name:"userName",onChange:v})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"Password"},"Contrase\xf1a"),r.a.createElement("input",{type:"password",className:"form-control",name:"password",id:"Password",onChange:v})),r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block my-4"},"Ingresar")))))))}var f=a(37),g=a.n(f),E=a(43),h=a(20),j=a(3),O=function(e){e.position;var t=Object(h.d)(j.TextureLoader,"".concat(".","/Assets/images/360_world_office.jpeg"));return r.a.createElement("mesh",null,r.a.createElement("sphereBufferGeometry",{attach:"geometry",args:[500,60,40]}),r.a.createElement("meshBasicMaterial",{attach:"material",map:t,side:j.BackSide}))},y=a(48);Object(h.b)({OrbitControls:y.a});var w=function(){var e=Object(h.e)(),t=e.camera,a=e.gl.domElement,c=Object(n.useRef)();return Object(h.c)((function(e){return c.current.update()})),r.a.createElement("orbitControls",{ref:c,args:[t,a],enableZoom:!1,maxAzimuthAngle:2*Math.PI,maxPolarAngle:Math.PI,minAzimuthAngle:2*-Math.PI,minPolarAngle:0})};function N(e){var t=e.url,a=e.position,c=e.state,o=e.setState,s=e.setFlagVideo,i=Object(n.useMemo)((function(){var e=document.createElement("video");return e.src=t,e.crossOrigin="Anonymous",e.pause(),e}),[t]),m=Object(n.useMemo)((function(){var e=new j.VideoTexture(i);return e.flipY=!0,e.minFilter=j.LinearFilter,e.magFilter=j.LinearFilter,e.format=j.RGBFormat,e}),[i]);return Object(n.useEffect)((function(){c.videoPlay?i.play():i.pause()}),[c,i]),Object(n.useEffect)((function(){i.addEventListener("ended",(function(e){s(!0)}))}),[i]),r.a.createElement("mesh",{position:a,onClick:function(e){o(Object(l.a)(Object(l.a)({},c),{},{videoPlay:!c.videoPlay}))},onMouseDown:function(e){o(Object(l.a)(Object(l.a)({},c),{},{videoPlay:!c.videoPlay}))}},r.a.createElement("planeBufferGeometry",{attach:"geometry",args:[3,2]}),r.a.createElement("meshBasicMaterial",{attach:"material",map:m}))}function k(e){var t=e.setVideoPlay,a=e.videoState,n=e.videoPlay;return r.a.createElement(r.a.Fragment,null,n?r.a.createElement("button",{type:"button",className:"btn btn-warning btn-block btn-lg mt-2",onClick:function(e){t(Object(l.a)(Object(l.a)({},a),{},{videoPlay:!a.videoPlay}))}},"Pausar"):r.a.createElement("button",{type:"button",className:"btn btn-success btn-block btn-lg mt-2",onClick:function(e){t(Object(l.a)(Object(l.a)({},a),{},{videoPlay:!a.videoPlay}))}},"Iniciar"))}function x(e){var t,a,n=e.Questions,c=(e.AnswerQuestions,e.CountQuestion),o=e.nextQuestion;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h5",null,null===(t=n[c])||void 0===t?void 0:t.question))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 d-flex flex-column"},n[c]?Object.entries(null===(a=n[c])||void 0===a?void 0:a.options).map((function(e,t){var a=Object(s.a)(e,2),n=a[0],c=a[1];return r.a.createElement("button",{name:"dato1",className:"btn btn-primary btn-block btn-lg",key:n+t,onClick:function(e){o()}},c)})):"")))}var S=a(49),C=a.n(S);function P(e){var t=e.UserName,a=e.Cont,c=e.nextQuestion,o=e.setFlagVideo,l=Object(n.useState)(!1),i=Object(s.a)(l,2),m=i[0],d=i[1],b=Object(n.useState)([]),v=Object(s.a)(b,2),p=v[0],f=v[1],g=Object(n.useRef)(null),E=Object(n.useRef)(null),h=u.storage(),j=u.database(),O=Object(n.useCallback)((function(e){var t=e.data;t.size>0&&f((function(e){return e.concat(t)}))}),[f]),y=Object(n.useCallback)((function(){d(!0),E.current=new MediaRecorder(g.current.stream,{mimeType:"video/webm"}),E.current.addEventListener("dataavailable",O),E.current.start()}),[O]),w=Object(n.useCallback)((function(){E.current.stop(),d(!1)}),[E]),N=Object(n.useCallback)((function(){var e=t;if(console.log(e),p.length){var n=new Blob(p,{type:"video/webm"});h.ref("/videos/".concat(e,"/pregunta-").concat(a,".webm")).put(n).then((function(t){t.ref.getDownloadURL().then((function(t){console.log(t),j.ref("users/".concat(e,"/answers/").concat(a)).update({url:t}),c(),o(!1)})),console.log("Uploaded a blob or file!")}));var r=URL.createObjectURL(n),l=document.createElement("a");document.body.appendChild(l),l.style="display: none",l.href=r,l.download="video-".concat(e,"-pregunta-").concat(a,".webm"),l.click(),window.URL.revokeObjectURL(r),f([])}}),[a,t,p,h]);return r.a.createElement("div",null,r.a.createElement(C.a,{className:"embed-responsive mt",audio:!0,ref:g,style:{maxHeight:"35em"}}),m?r.a.createElement("button",{className:"btn btn-danger btn-lg btn-block m-2",onClick:w},"Parar Grabaci\xf3n"):r.a.createElement("button",{className:"btn btn-success btn-lg btn-block m-2",onClick:y},"Iniciar Grabaci\xf3n"),p.length>0&&r.a.createElement("button",{className:"btn btn-primary btn-lg btn-block m-2",onClick:function(){return N(t)}},"Descargar y Enviar Video Respuesta"))}var A=function(e){var t,a=e.userState,c=e.setUserState,o=Object(n.useState)({videoPlay:!1,url:"".concat(".","/Assets/videos/p6.mp4")}),i=Object(s.a)(o,2),d=i[0],b=i[1],v=Object(n.useState)(!1),p=Object(s.a)(v,2),f=p[0],j=p[1],y=Object(n.useState)(6),S=Object(s.a)(y,2),C=S[0],A=S[1],R=Object(n.useState)({1:{options:{},video:!1}}),M=Object(s.a)(R,2),L=M[0],U=M[1],F=Object(n.useState)({}),I=Object(s.a)(F,2),B=I[0],z=I[1],Q=u.database(),V=Q.ref("questions"),D=Q.ref("answer_questions"),T=Object(m.g)();Object(n.useEffect)((function(){V.on("value",(function(e){U(e.toJSON())})),D.on("value",(function(e){z(e.toJSON())}))}),[]);var G=function(){var e=Object(E.a)(g.a.mark((function e(){var t,n=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:"a",console.log(C),C===Object.keys(B).length){e.next=10;break}A(C+1),B[C].answer===t?Q.ref("users/".concat(a.uid,"/answers/").concat(C)).update({option:"a",rating:1}):Q.ref("users/".concat(a.uid,"/answers/").concat(C)).update({option:"a",rating:0}),b(Object(l.a)(Object(l.a)({},d),{},{url:"".concat(".","/Assets/videos/p").concat(C<Object.keys(L).length?C+1:C,".mp4")})),j(!1),e.next=13;break;case 10:return e.next=12,c(Object(l.a)(Object(l.a)({},a),{},{state:!1,email:""}));case 12:u.auth().signOut().then((function(){T.push("/")})).catch((function(e){}));case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row justify-content-center mt-4 mb-5"},r.a.createElement("div",{className:"col-md-8"},f?(null===(t=L[C])||void 0===t?void 0:t.video)?r.a.createElement(P,{UserName:a.uid,Cont:C,nextQuestion:function(){A(C+1),Q.ref("users/".concat(a.uid,"/answers/").concat(C)).update({option:"a",rating:0})},setFlagVideo:j}):r.a.createElement("div",null):r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{colorManagement:!0,style:{height:"500px",border:"3px solid black",width:"100%"},camera:{position:[0,0,.1]}},r.a.createElement(w,null),r.a.createElement("ambientLight",{intensity:.2}),r.a.createElement("spotLight",{position:[10,10,10],angle:.15,penumbra:1}),r.a.createElement("pointLight",{position:[-10,-10,-10]}),r.a.createElement(n.Suspense,{fallback:null},r.a.createElement(O,null)),r.a.createElement(N,{position:[0,0,-3],url:d.url,state:d,setState:b,setFlagVideo:j})),r.a.createElement(k,{videoState:d,setVideoPlay:b,videoPlay:d.videoPlay}))),f?r.a.createElement("div",{className:"col-md-6"},r.a.createElement(x,{Questions:L,AnswerQuestions:B,CountQuestion:C,nextQuestion:G})):r.a.createElement("div",{className:""})))};function R(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center hv-75"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("h1",{className:"text-center",style:{fontSize:"180px",fontWeight:700}},"404"),r.a.createElement("h4",{className:"text-center"},"P\xe1gina web no encontrada"))))}var M=function(){var e=Object(n.useState)({state:!1,uid:"",initializing:!0,email:""}),t=Object(s.a)(e,2),a=t[0],c=t[1];Object(n.useEffect)((function(){u.auth().onAuthStateChanged((function(e){if(e){var t=e.uid,n=e.email;c(Object(l.a)(Object(l.a)({},a),{},{uid:t,state:!0,initializing:!1,email:n}))}else c(Object(l.a)(Object(l.a)({},a),{},{uid:"",state:!1,initializing:!1,email:""}))}))}),[c]);var o=function(e){c(Object(l.a)(Object(l.a)({},a),{},{initializing:e}))};return a.initializing?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 vh-100 d-flex flex-column justify-content-center align-items-center"},r.a.createElement("div",{className:"spinner-border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Cargando...")),r.a.createElement("p",null,"Cargando")))):r.a.createElement(i.a,null,r.a.createElement(v,{userMail:a.email}),r.a.createElement(m.d,null,r.a.createElement(b,{exact:!0,path:"/test",user:a.state,component:A,userState:a,setUserState:c}),r.a.createElement(m.b,{exact:!0,path:"/",render:function(e){return""===a.email?r.a.createElement(p,{SetStateRoute:o}):r.a.createElement(m.a,{to:{pathname:"/test",state:{from:e.location}}})}}),r.a.createElement(m.b,{path:"*"},r.a.createElement(R,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(75),a(76);var L={apiKey:"AIzaSyAMCRd5n-be6H3TmUdwZAUnstxAXRn6I_4",authDomain:"vr-derco-admin.firebaseapp.com",databaseURL:"https://vr-derco-admin.firebaseio.com",projectId:"vr-derco-admin",storageBucket:"vr-derco-admin.appspot.com",messagingSenderId:"480451728887",appId:"1:480451728887:web:511444325186c793684af2"};u.initializeApp(L),o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[51,1,2]]]);
//# sourceMappingURL=main.f1c32f08.chunk.js.map