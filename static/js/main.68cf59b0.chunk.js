(this["webpackJsonpvideorecording-threejs"]=this["webpackJsonpvideorecording-threejs"]||[]).push([[0],{51:function(e,t,a){e.exports=a(78)},55:function(e,t,a){},78:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(41),o=a.n(c),l=(a(55),a(7)),s=a(6),i=a(17),m=a(9),u=a(12),d=a(50),b=function(e){var t=e.component,a=e.user,n=Object(d.a)(e,["component","user"]);return r.a.createElement(m.b,Object.assign({},n,{render:function(e){return a?r.a.createElement(t,Object.assign({},n,e)):r.a.createElement(m.a,{to:{pathname:"/",state:{from:e.location}}})}}))};function p(e){var t=e.userMail,a=Object(m.g)();return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},r.a.createElement(i.b,{className:"navbar-brand",to:"/test"},r.a.createElement("img",{src:"".concat(".","/Assets/images/kaleidolab.jpg"),alt:"",width:"120"})),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarTogglerDemo02","aria-controls":"navbarTogglerDemo02","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarTogglerDemo02"},r.a.createElement("ul",{className:"navbar-nav mr-auto mt-2 mt-lg-0"},r.a.createElement("li",{className:"nav-item active"}),r.a.createElement("li",{className:"nav-item active"})),""!==t?r.a.createElement("div",{className:"dropdown"},r.a.createElement("button",{className:"btn btn-secondary dropdown-toggle my-2 my-lg-0",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},t),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},r.a.createElement(i.b,{className:"dropdown-item",to:"",onClick:function(){u.auth().signOut().then((function(){a.push("/")})).catch((function(e){}))}},"Cerrar sesion"))):""))}function v(e){var t=e.SetStateRoute,a=Object(n.useState)({userName:"",password:""}),c=Object(s.a)(a,2),o=c[0],i=c[1],d=Object(m.g)();var b=function(){u.auth().signInWithEmailAndPassword(o.userName,o.password).then((function(e){t(!0),d.push("/test")})).catch((function(e){alert("No se pudo iniciar sesion")}))};function p(e){var t=e.target.name,a=e.target.value;i("userName"===t?Object(l.a)(Object(l.a)({},o),{},{userName:a}):Object(l.a)(Object(l.a)({},o),{},{password:a}))}return r.a.createElement("div",{className:"container-fluid vh-100"},r.a.createElement("div",{className:"row justify-content-center h-100"},r.a.createElement("div",{className:"col-md-6 d-flex align-items-center"},r.a.createElement("div",{className:"card shadow w-100",style:{height:"35em"}},r.a.createElement("div",{className:"card-header d-flex flex-column align-items-center justify-content-center bg-white border-bottom-0"},r.a.createElement("img",{src:"".concat(".","/Assets/images/kaleidolab.jpg"),alt:"",width:"300"}),r.a.createElement("h3",null,"Assessment VR"),r.a.createElement("p",{className:"text-center"},"La experiencia de realidad virtual para desarrollar y aplicar evaluaciones de comportamientos ante situaciones inesperadas")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),b()}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"usuario"},"Usuario"),r.a.createElement("input",{type:"text",className:"form-control",id:"usuario","aria-describedby":"emailHelp",name:"userName",value:o.userName,onChange:p})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"Password"},"Contrase\xf1a"),r.a.createElement("input",{type:"password",className:"form-control",name:"password",value:o.password,id:"Password",onChange:p})),r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block my-4"},"Ingresar")))))))}var f=a(37),g=a.n(f),E=a(43),h=a(20),j=a(3),N=function(e){e.position;var t=e.url,a=e.state,c=(e.setState,e.setFlagVideo),o=Object(n.useMemo)((function(){var e=document.createElement("video");return e.src=t,e.crossOrigin="Anonymous",e.pause(),e}),[t]),l=Object(n.useMemo)((function(){var e=new j.VideoTexture(o);return e.flipY=!0,e.minFilter=j.LinearFilter,e.magFilter=j.LinearFilter,e.format=j.RGBFormat,e}),[o]);return Object(n.useEffect)((function(){a.videoPlay?o.play():o.pause()}),[a,o]),Object(n.useEffect)((function(){o.addEventListener("ended",(function(e){c(!0)}))}),[o]),r.a.createElement("mesh",null,r.a.createElement("sphereBufferGeometry",{attach:"geometry",args:[500,60,40]}),r.a.createElement("meshBasicMaterial",{attach:"material",map:l,side:j.BackSide}))},O=a(48);Object(h.b)({OrbitControls:O.a});var y=function(){var e=Object(h.e)(),t=e.camera,a=e.gl.domElement,c=Object(n.useRef)();return Object(h.c)((function(e){return c.current.update()})),r.a.createElement("orbitControls",{ref:c,args:[t,a],enableZoom:!1,maxAzimuthAngle:2*Math.PI,maxPolarAngle:Math.PI,minAzimuthAngle:2*-Math.PI,minPolarAngle:0})};function w(e){var t=e.setVideoPlay,a=e.videoState,n=e.videoPlay;return r.a.createElement(r.a.Fragment,null,n?r.a.createElement("button",{type:"button",className:"btn btn-warning btn-block btn-lg mt-2",onClick:function(e){t(Object(l.a)(Object(l.a)({},a),{},{videoPlay:!a.videoPlay}))}},"Pausar"):r.a.createElement("button",{type:"button",className:"btn btn-success btn-block btn-lg mt-2",onClick:function(e){t(Object(l.a)(Object(l.a)({},a),{},{videoPlay:!a.videoPlay}))}},"Iniciar"))}function k(e){var t,a,n=e.Questions,c=(e.AnswerQuestions,e.CountQuestion),o=e.nextQuestion;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h5",null,null===(t=n[c])||void 0===t?void 0:t.question))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 d-flex flex-column"},n[c]?Object.entries(null===(a=n[c])||void 0===a?void 0:a.options).map((function(e,t){var a=Object(s.a)(e,2),n=a[0],c=a[1];return r.a.createElement("button",{name:"dato1",className:"btn btn-primary btn-block btn-lg",key:n+t,onClick:function(e){o()}},c)})):"")))}var x=a(49),S=a.n(x);function C(e){var t=e.UserName,a=e.Cont,c=e.nextQuestion,o=e.setFlagVideo,l=Object(n.useState)(!1),i=Object(s.a)(l,2),m=i[0],d=i[1],b=Object(n.useState)([]),p=Object(s.a)(b,2),v=p[0],f=p[1],g=Object(n.useRef)(null),E=Object(n.useRef)(null),h=u.storage(),j=u.database(),N=Object(n.useCallback)((function(e){var t=e.data;t.size>0&&f((function(e){return e.concat(t)}))}),[f]),O=Object(n.useCallback)((function(){d(!0),E.current=new MediaRecorder(g.current.stream,{mimeType:"video/webm"}),E.current.addEventListener("dataavailable",N),E.current.start()}),[N]),y=Object(n.useCallback)((function(){E.current.stop(),d(!1)}),[E]),w=Object(n.useCallback)((function(){var e=t;if(console.log(e),v.length){var n=new Blob(v,{type:"video/webm"});h.ref("/videos/".concat(e,"/pregunta-").concat(a,".webm")).put(n).then((function(t){t.ref.getDownloadURL().then((function(t){console.log(t),j.ref("users/".concat(e,"/answers/").concat(a)).update({url:t}),c(),o(!1)})),console.log("Uploaded a blob or file!")}));var r=URL.createObjectURL(n),l=document.createElement("a");document.body.appendChild(l),l.style="display: none",l.href=r,l.download="video-".concat(e,"-pregunta-").concat(a,".webm"),l.click(),window.URL.revokeObjectURL(r),f([])}}),[a,t,v,h]);return r.a.createElement("div",null,r.a.createElement(S.a,{className:"embed-responsive mt",audio:!0,ref:g,style:{maxHeight:"35em"}}),m?r.a.createElement("button",{className:"btn btn-danger btn-lg btn-block m-2",onClick:y},"Parar Grabaci\xf3n"):r.a.createElement("button",{className:"btn btn-success btn-lg btn-block m-2",onClick:O},"Iniciar Grabaci\xf3n"),v.length>0&&r.a.createElement("button",{className:"btn btn-primary btn-lg btn-block m-2",onClick:function(){return w(t)}},"Descargar y Enviar Video Respuesta"))}var A=function(e){var t,a=e.userState,c=e.setUserState,o=Object(n.useState)({videoPlay:!1,url:"".concat(".","/Assets/videos/p1.mp4")}),i=Object(s.a)(o,2),d=i[0],b=i[1],p=Object(n.useState)(!1),v=Object(s.a)(p,2),f=v[0],j=v[1],O=Object(n.useState)(1),x=Object(s.a)(O,2),S=x[0],A=x[1],P=Object(n.useState)({1:{options:{},video:!1}}),U=Object(s.a)(P,2),R=U[0],F=U[1],L=Object(n.useState)({}),M=Object(s.a)(L,2),I=M[0],z=M[1],B=u.database(),Q=B.ref("questions"),D=B.ref("answer_questions"),V=Object(m.g)();Object(n.useEffect)((function(){Q.on("value",(function(e){F(e.toJSON())})),D.on("value",(function(e){z(e.toJSON())})),B.ref("users/".concat(a.uid)).update({lastName:a.lastName||"no lastName",name:a.name||"no name"})}),[]);var T=function(){var e=Object(E.a)(g.a.mark((function e(){var t,n=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:"a",console.log(S),S===Object.keys(I).length){e.next=10;break}A(S+1),I[S].answer===t?B.ref("users/".concat(a.uid,"/answers/").concat(S)).update({option:"a",rating:1}):B.ref("users/".concat(a.uid,"/answers/").concat(S)).update({option:"a",rating:0}),b(Object(l.a)(Object(l.a)({},d),{},{url:"".concat(".","/Assets/videos/p").concat(S<Object.keys(R).length?S+1:S,".mp4")})),j(!1),e.next=13;break;case 10:return e.next=12,c(Object(l.a)(Object(l.a)({},a),{},{state:!1,email:""}));case 12:u.auth().signOut().then((function(){V.push("/")})).catch((function(e){}));case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row justify-content-center mt-4 mb-5"},r.a.createElement("div",{className:"col-md-8"},f?(null===(t=R[S])||void 0===t?void 0:t.video)?r.a.createElement(C,{UserName:a.uid,Cont:S,nextQuestion:function(){A(S+1),B.ref("users/".concat(a.uid,"/answers/").concat(S)).update({option:"a",rating:0})},setFlagVideo:j}):r.a.createElement("div",null):r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{colorManagement:!0,style:{height:"500px",border:"3px solid black",width:"100%"},camera:{position:[0,0,.1]}},r.a.createElement(y,null),r.a.createElement("ambientLight",{intensity:.2}),r.a.createElement("spotLight",{position:[10,10,10],angle:.15,penumbra:1}),r.a.createElement("pointLight",{position:[-10,-10,-10]}),r.a.createElement(n.Suspense,{fallback:null},r.a.createElement(N,{position:[0,0,-3],url:d.url,state:d,setState:b,setFlagVideo:j}))),r.a.createElement(w,{videoState:d,setVideoPlay:b,videoPlay:d.videoPlay}))),f?r.a.createElement("div",{className:"col-md-6"},r.a.createElement(k,{Questions:R,AnswerQuestions:I,CountQuestion:S,nextQuestion:T})):r.a.createElement("div",{className:""})))},P=a(5);function U(e){var t=e.userState,a=e.setUserState,c=Object(n.useState)({}),o=Object(s.a)(c,2),i=o[0],d=o[1],b=Object(m.g)(),p=function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;d(Object(l.a)(Object(l.a)({},i),{},Object(P.a)({},n,a)))};return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-md-8 mt-5"},r.a.createElement("form",{className:"card",onSubmit:function(e){e.preventDefault();var n=u.auth().currentUser,r=i.name,c=i.lastName;n.updateProfile({displayName:"".concat(r,"-").concat(c)}).then((function(){a(Object(l.a)(Object(l.a)({},t),{},{name:r,lastName:c})),alert("datos guardados satisfactoriamente"),b.push("/test")})).catch((function(e){alert("No se pudieron guardar los datos satisfactoriamente")}))}},r.a.createElement("div",{className:"card-body"},r.a.createElement("h2",{className:"card-title text-center"},"Datos de usuario"),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"name"},"Nombre"),r.a.createElement("input",{type:"text",className:"form-control",id:"name",placeholder:"Nombre...",onClick:p,required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"lastName"},"Apellidos"),r.a.createElement("input",{type:"text",className:"form-control",id:"lastName",placeholder:"Apellidos...",onClick:p,required:!0}))),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Guardar")))))}function R(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center hv-75"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("h1",{className:"text-center",style:{fontSize:"180px",fontWeight:700}},"404"),r.a.createElement("h4",{className:"text-center"},"P\xe1gina web no encontrada"))))}var F=function(){var e=Object(n.useState)({state:!1,uid:"",initializing:!0,email:""}),t=Object(s.a)(e,2),a=t[0],c=t[1];Object(n.useEffect)((function(){u.auth().onAuthStateChanged((function(e){if(e){var t=e.uid,n=e.email;c(Object(l.a)(Object(l.a)({},a),{},{uid:t,state:!0,initializing:!1,email:n}))}else c(Object(l.a)(Object(l.a)({},a),{},{uid:"",state:!1,initializing:!1,email:""}))}))}),[c]);var o=function(e){c(Object(l.a)(Object(l.a)({},a),{},{initializing:e}))};return a.initializing?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 vh-100 d-flex flex-column justify-content-center align-items-center"},r.a.createElement("div",{className:"spinner-border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Cargando...")),r.a.createElement("p",null,"Cargando")))):r.a.createElement(i.a,null,r.a.createElement(p,{userMail:a.email}),r.a.createElement(m.d,null,r.a.createElement(b,{exact:!0,path:"/test",user:a.state,component:A,userState:a,setUserState:c}),r.a.createElement(b,{exact:!0,path:"/formUser",user:a.state,component:U,userState:a,setUserState:c}),r.a.createElement(m.b,{exact:!0,path:"/",render:function(e){return""===a.email?r.a.createElement(v,{SetStateRoute:o}):r.a.createElement(m.a,{to:{pathname:"/test",state:{from:e.location}}})}}),r.a.createElement(m.b,{path:"*"},r.a.createElement(R,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(75),a(76);var L={apiKey:"AIzaSyAMCRd5n-be6H3TmUdwZAUnstxAXRn6I_4",authDomain:"vr-derco-admin.firebaseapp.com",databaseURL:"https://vr-derco-admin.firebaseio.com",projectId:"vr-derco-admin",storageBucket:"vr-derco-admin.appspot.com",messagingSenderId:"480451728887",appId:"1:480451728887:web:511444325186c793684af2"};u.initializeApp(L),o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[51,1,2]]]);
//# sourceMappingURL=main.68cf59b0.chunk.js.map